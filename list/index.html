<div class="list">
    {{#with todo=todo todos=todos app=app back=back}}
        <h1>
            {{#if back}}
                <a href="#" onclick::{{@setTodo(app, back)}} class="back">
                    ▲
                </a>
            {{else}}
                {{#if todo.cog}}
                    <a href="#" onclick::{{@setTodo(app, todo.cog)}} class="cog">
                        ◉
                    </a>
                {{/if}}
            {{/if}}

            <input type="text" disabled::{{!todo.id}} value::{{todo.title}} onblur::{{@set(app, 'title', undefined, todo)}}>
        </h1>

        <ul class="todos">
            {{#each @findTodos(todo, todos)}}
                <li data-id="{{id}}">
                    <a href="#" onclick::{{@setTodo(app, this)}} class="go">
                        &raquo;
                    </a>

                    <a href="#" onclick::{{@deleteTodo(app, this)}} class="delete">
                        x
                    </a>

                    <input type="text" value::{{title}} onblur::{{@setTodoInfo(this, 'title')}}>
                </li>
            {{/each}}
        </ul>

        {{#if isAdding}}
            <ul class="new-item">
                <li>
                    <form onsubmit::{{@add(app, list, todo)}}>
                        <input type="text" value::{{newTodo.title}} oninput::{{@set(list, 'newTodo.title')}} onblur::{{@add(app, list, todo, 1)}}>
                    </form>
                </li>
            </ul>
        {{/if}}
    {{/with}}
</div>

<div class="list-underlay" onclick::{{@addItem(list)}}></div>
